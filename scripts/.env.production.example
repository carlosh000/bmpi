# Copia este archivo como scripts/.env.production y completa los valores reales.
# No subas el archivo .env.production al repositorio.

BMPI_ENV=production

# Backend HTTP + frontend SSR
BMPI_HTTP_ADDR=:8080
BMPI_API_BASE_URL=http://127.0.0.1:8080
BMPI_ALLOWED_ORIGINS=http://localhost:4000,http://127.0.0.1:4000

# Seguridad de API
BMPI_OPERATOR_API_KEY=REEMPLAZAR_CON_CLAVE_OPERATOR
BMPI_ADMIN_API_KEY=REEMPLAZAR_CON_CLAVE_ADMIN

# Base de datos
DB_HOST=localhost
DB_NAME=bmpi
DB_USER=postgres
DB_PASSWORD=REEMPLAZAR_CON_PASSWORD_DB
DB_SSLMODE=require

# gRPC entre backend e IA
BMPI_FACE_GRPC_ADDR=127.0.0.1:50051
BMPI_FACE_GRPC_TLS=false
# BMPI_FACE_GRPC_CA_CERT=C:\ruta\ca.pem

# Extracción de embeddings (validado en pruebas finales locales)
# legacy = más rápido en este entorno actual
BMPI_EXTRACT_MODE=legacy
# Ajusta workers según CPU/latencia objetivo
BMPI_EXTRACT_WORKERS=8
# Registro de fotos: mantener en 1 para máxima estabilidad del servicio IA
BMPI_REGISTER_PHOTO_WORKERS=1

# Calidad automática en register-photos (advertencias, no bloquea guardado)
BMPI_QUALITY_MIN_DIMENSION=220
BMPI_QUALITY_BRIGHTNESS_MIN=55
BMPI_QUALITY_BRIGHTNESS_MAX=210
BMPI_QUALITY_DETAIL_MIN=2.5

# TLS opcional del servicio IA
BMPI_GRPC_TLS=false
# BMPI_GRPC_CERT_FILE=C:\ruta\server-cert.pem
# BMPI_GRPC_KEY_FILE=C:\ruta\server-key.pem

# Ajustes IA
BMPI_FACE_MODEL=hog
BMPI_FACE_MODEL_FALLBACK=cnn
BMPI_FACE_HAAR_FALLBACK=true
BMPI_HAAR_MIN_FACE=64
BMPI_FACE_CONTRAST_FALLBACK=true
BMPI_FACE_ROTATION_FALLBACK=true
BMPI_FACE_ROTATION_ANGLES=-12,12,-20,20
BMPI_FACE_THRESHOLD=0.55
BMPI_FACE_ENCODING_MODEL=small
BMPI_FACE_ENCODING_JITTERS_REGISTER=2
BMPI_FACE_ENCODING_JITTERS_RECOGNIZE=1
BMPI_MAX_PROTOTYPES_PER_EMPLOYEE=6
BMPI_FACE_DETECT_UPSAMPLE=1
BMPI_FACE_DETECT_RETRY_UPSAMPLE=2
BMPI_EMBEDDINGS_REFRESH_SECONDS=30
BMPI_GRPC_WORKERS=4
# Concurrencia interna de face_recognition (1 = estabilidad máxima)
BMPI_FACE_ENCODE_CONCURRENCY=1
# Límite de mensaje gRPC en MB para imágenes/fotos grandes
BMPI_GRPC_MAX_MSG_MB=20
